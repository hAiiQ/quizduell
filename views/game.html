<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jeopardy - Game</title>
    <link rel="stylesheet" href="/css/style.css">
    <style>
        /* Game Styles */
        .game-cameras-section {
            background: #2a2a2a;
            border-radius: 12px;
            padding: 15px;
            margin: 20px 0;
            border: 2px solid #444;
        }
        
        .cameras-row {
            width: 100%;
            height: 300px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 15px;
            overflow: hidden;
            position: relative;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }
        
        /* Video Setup Styles */
        .video-setup-container {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 30px;
            box-sizing: border-box;
        }
        
        .video-setup-content {
            text-align: center;
            color: white;
            max-width: 600px;
        }
        
        .video-options {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .video-option {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 140px;
        }
        
        .video-option:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .option-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
        }
        
        .option-icon {
            font-size: 28px;
            margin-bottom: 5px;
        }
        
        .option-info {
            text-align: center;
        }
        
        .option-title {
            font-size: 14px;
            font-weight: bold;
            margin-bottom: 3px;
        }
        
        .option-desc {
            font-size: 11px;
            opacity: 0.8;
        }
        
        .option-btn {
            background: rgba(255, 255, 255, 0.3);
            border: none;
            border-radius: 6px;
            padding: 6px 12px;
            font-size: 12px;
            color: white;
            font-weight: bold;
            margin-top: 5px;
        }
        
        /* Instructions Styles */
        .video-instructions-container {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 30px;
            box-sizing: border-box;
        }
        
        .video-instructions-content {
            text-align: left;
            color: white;
            max-width: 500px;
        }
        
        .instructions-list {
            margin: 20px 0;
        }
        
        .instruction-step {
            background: rgba(255, 255, 255, 0.1);
            padding: 8px 12px;
            margin: 5px 0;
            border-radius: 6px;
            font-size: 14px;
        }
        
        .url-display {
            background: rgba(255, 255, 255, 0.2);
            padding: 10px;
            border-radius: 8px;
            margin: 15px 0;
            font-family: monospace;
            font-size: 12px;
            word-break: break-all;
        }
        
        .instructions-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        .instruction-btn {
            padding: 10px 15px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        .instruction-btn.primary {
            background: #4CAF50;
            color: white;
        }
        
        .instruction-btn.secondary {
            background: rgba(255, 255, 255, 0.2);
            color: white;
        }
        
        .instruction-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }

        .game-board {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }

        .category-header {
            background: #003366;
            color: white;
            padding: 15px;
            text-align: center;
            font-weight: bold;
            border-radius: 8px;
            font-size: 16px;
        }

        .question-cell {
            background: #004080;
            color: #FFD700;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            border-radius: 8px;
            font-size: 24px;
            font-weight: bold;
            transition: all 0.3s;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .question-cell:hover {
            background: #0066CC;
            transform: scale(1.05);
        }

        .question-cell.used {
            background: #333;
            color: #666;
            cursor: not-allowed;
            transform: none;
        }

        .players-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .player-card {
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
        }

        .player-card.current {
            border-color: #007bff;
            background: #e7f3ff;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
        }

        .modal-content {
            background: white;
            margin: 5% auto;
            padding: 30px;
            width: 80%;
            max-width: 600px;
            border-radius: 15px;
            text-align: center;
        }

        .controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s;
        }

        .btn.primary { background: #007bff; color: white; }
        .btn.success { background: #28a745; color: white; }
        .btn.danger { background: #dc3545; color: white; }
        .btn.secondary { background: #6c757d; color: white; }

        .btn:hover { transform: translateY(-2px); }

        @media (max-width: 768px) {
            .game-board {
                grid-template-columns: repeat(3, 1fr);
                gap: 5px;
                padding: 10px;
            }
            .question-cell { font-size: 18px; padding: 15px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="game-header">
            <h1>🎮 Jeopardy Game</h1>
            <div id="room-info">Lobby: <span id="room-code"></span></div>
        </div>

        <!-- Video Chat Setup -->
        <div class="game-cameras-section">
            <h2 style="color: white; text-align: center; margin-bottom: 15px;">📹 Video-Chat Setup</h2>
            <div id="game-video-container" class="cameras-row">
                <div id="video-setup" class="video-setup-container">
                    <div class="video-setup-content">
                        <h3 style="color: #333; margin-bottom: 15px; text-align: center;">🎥 Video-Chat für alle Spieler</h3>
                        <p style="font-size: 14px; color: #666; margin-bottom: 20px; text-align: center;">
                            Erstellt gemeinsam einen Video-Chat für das Spiel
                        </p>
                        
                        <div class="video-options">
                            <div class="video-option" onclick="createJitsiRoom()">
                                <div class="option-content">
                                    <div class="option-icon">📹</div>
                                    <div class="option-info">
                                        <div class="option-title">Jitsi Meet</div>
                                        <div class="option-desc">Kostenlos & einfach</div>
                                    </div>
                                    <div class="option-btn">Erstellen</div>
                                </div>
                            </div>
                            
                            <div class="video-option" onclick="createDiscordChannel()">
                                <div class="option-content">
                                    <div class="option-icon">🎮</div>
                                    <div class="option-info">
                                        <div class="option-title">Discord</div>
                                        <div class="option-desc">Sprachkanal</div>
                                    </div>
                                    <div class="option-btn">Erstellen</div>
                                </div>
                            </div>
                            
                            <div class="video-option" onclick="showManualInstructions()">
                                <div class="option-content">
                                    <div class="option-icon">💡</div>
                                    <div class="option-info">
                                        <div class="option-title">Andere Lösung</div>
                                        <div class="option-desc">Zoom, Teams, etc.</div>
                                    </div>
                                    <div class="option-btn">Anleitung</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Current Player Display -->
        <div id="current-player-display" style="display: none;">
            <h3>Aktueller Spieler: <span id="current-player-name"></span></h3>
        </div>

        <!-- Players Section -->
        <div id="players-section" class="players-section"></div>

        <!-- Game Board -->
        <div id="game-board" class="game-board"></div>

        <!-- Controls -->
        <div class="controls">
            <button id="nextRoundBtn" class="btn primary" style="display: none;">Nächste Runde</button>
            <button id="endGameBtn" class="btn danger" style="display: none;">Spiel beenden</button>
        </div>
    </div>

    <!-- Question Modal -->
    <div id="questionModal" class="modal">
        <div class="modal-content">
            <h2 id="modalCategory"></h2>
            <h3 id="modalQuestion"></h3>
            <p id="modalPoints"></p>
            <div id="modalControls" class="controls"></div>
            <button onclick="closeModal()" class="btn secondary">Schließen</button>
        </div>
    </div>

    <!-- Game Over Modal -->
    <div id="gameOverModal" class="modal">
        <div class="modal-content">
            <h2>🎉 Spiel beendet!</h2>
            <div id="finalResults"></div>
            <button onclick="goHome()" class="btn primary">Zurück zur Startseite</button>
        </div>
    </div>

    <!-- Socket.IO -->
    <script src="/socket.io/socket.io.js"></script>
    
    <!-- Game Logic -->
    <script src="/js/game.js"></script>

    <script>
        // Video Setup Functions
        function createJitsiRoom() {
            const pathParts = window.location.pathname.split('/');
            const lobbyId = pathParts[pathParts.length - 1] || 'game';
            const roomName = `JeopardyGame-${lobbyId}`;
            const jitsiUrl = `https://meet.jit.si/${roomName}`;
            
            showVideoInstructions('Jitsi Meet', jitsiUrl, [
                '1. Klickt auf "Jitsi Meet öffnen" um den Raum zu öffnen',
                '2. Alle Spieler treten demselben Raum bei',
                '3. Aktiviert eure Kameras und Mikrofone',
                '4. Kehrt zu diesem Tab zurück um zu spielen',
                '5. Lasst den Jitsi-Tab während des Spiels offen'
            ]);
        }
        
        function createDiscordChannel() {
            showVideoInstructions('Discord Sprachkanal', '', [
                '1. Erstellt einen Sprachkanal auf eurem Discord-Server',
                '2. Teilt den Einladungslink mit allen Spielern', 
                '3. Alle Spieler treten dem Kanal bei',
                '4. Aktiviert eure Mikrofone (und optional Kameras)',
                '5. Kehrt zu diesem Tab zurück um zu spielen'
            ]);
        }
        
        function showManualInstructions() {
            showVideoInstructions('Andere Video-Chat Optionen', '', [
                '🎥 Zoom: Erstellt ein Meeting und teilt den Link',
                '💼 Microsoft Teams: Startet eine Besprechung',
                '📱 WhatsApp: Startet einen Gruppenanruf',
                '🍎 FaceTime: Erstellt eine Gruppenkonferenz (iOS/Mac)',
                '📞 Skype: Startet einen Gruppenanruf',
                '',
                '💡 Tipp: Teilt den Video-Chat Link im Game-Chat',
                '⚠️ Lasst den Video-Chat während des Spiels offen'
            ]);
        }
        
        function showVideoInstructions(title, url, steps) {
            const container = document.getElementById('video-setup');
            container.innerHTML = `
                <div class="video-instructions-container">
                    <div class="video-instructions-content">
                        <h3 style="color: white; margin-bottom: 20px; text-align: center;">📹 ${title}</h3>
                        <div class="instructions-list">
                            ${steps.map(step => step ? `<div class="instruction-step">${step}</div>` : '<div style="height: 10px;"></div>').join('')}
                        </div>
                        ${url ? `<div class="url-display">🔗 Raum-Link: ${url}</div>` : ''}
                        <div class="instructions-actions">
                            <button onclick="location.reload()" class="instruction-btn secondary">🔄 Andere Option wählen</button>
                            ${url ? `<button onclick="window.open('${url}', '_blank')" class="instruction-btn primary">🚀 ${title} öffnen</button>` : ''}
                        </div>
                    </div>
                </div>
            `;
        }

        function closeModal() {
            document.getElementById('questionModal').style.display = 'none';
        }

        function goHome() {
            sessionStorage.clear();
            window.location.href = '/';
        }
    </script>
</body>
</html>